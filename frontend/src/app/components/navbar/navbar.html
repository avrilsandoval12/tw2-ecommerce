<nav class="navbar">
  <div class="navbar-container">
    <button class="back-link">
      <span class="arrow">‚Üê</span>
      <span>Volver</span>
    </button>
    <div class="spacer"></div>
    <h1 class="brand">
      <a routerLink="/">Silhouette</a>
    </h1>

    <button class="cart-button" (click)="toggleCart()">
      üõí
      @if (cartService.totalItems() > 0) {
        <span class="cart-badge">{{ cartService.totalItems() }}</span>
      }
    </button>
  </div>

  @if (isCartOpen()) {
    <div class="cart-dropdown-overlay" (click)="closeCart()"></div>
    <div class="cart-dropdown">
      <div class="cart-header">
        <h3>Mi Carrito</h3>
        <button class="close-btn" (click)="closeCart()">‚úï</button>
      </div>

      @if (cartService.items().length === 0) {
        <div class="empty-cart">
          <p>Tu carrito est√° vac√≠o</p>
        </div>
      } @else {
        <div class="cart-items">
          @for (item of cartService.items(); track item.product.id) {
            <div class="cart-item">
              <img
                [src]="item.product.imageUrl || 'assets/no-image.png'"
                [alt]="item.product.name"
                class="item-image">

              <div class="item-info">
                <h4>{{ item.product.name }}</h4>
                <p class="item-price">
                  ${{ item.product.price | number:'1.2-2' }} x {{ item.quantity }}
                </p>
                <p class="item-total">
                  <strong>${{ (item.product.price * item.quantity) | number:'1.2-2' }}</strong>
                </p>
              </div>

              <button
                class="remove-btn"
                (click)="removeItem(item.product.id)"
                title="Eliminar">
                üóëÔ∏è
              </button>
            </div>
          }
        </div>

        <div class="cart-footer">
          <div class="cart-total">
            <span>Total:</span>
            <strong>${{ cartService.totalPrice() | number:'1.2-2' }}</strong>
          </div>

          <a
            routerLink="/cart"
            class="view-cart-btn"
            (click)="closeCart()">
            Ver Carrito Completo
          </a>
        </div>
      }
    </div>
  }
</nav>
