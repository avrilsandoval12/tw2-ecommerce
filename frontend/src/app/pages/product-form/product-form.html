<div class="container py-5">
  <div class="row justify-content-center">
    <div class="col-lg-10 col-xl-8">
      <div class="card shadow-sm border-0">
        <div class="card-body p-4">
          <h2 class="text-center mb-4 fw-bold">
            @if (modoEdicion) {
              Editar Producto
            } @else {
              Crear Nuevo Producto
            }
          </h2>

          <form [formGroup]="productForm" (ngSubmit)="onSubmit()">

            <div class="mb-3">
              <label for="nombre" class="form-label fw-semibold">Nombre</label>
              <input
                id="nombre"
                type="text"
                formControlName="nombre"
                class="form-control"
                [class.is-invalid]="nombre && nombre.invalid && (nombre.dirty || nombre.touched)"
                placeholder="Nombre del producto"
              >
              @if (nombre && nombre.invalid && (nombre.dirty || nombre.touched)) {
                <div class="invalid-feedback">
                  @if (nombre.errors?.['required']) {
                    El nombre es obligatorio.
                  }
                  @if (nombre.errors?.['maxlength']) {
                    El nombre no puede exceder los 100 caracteres.
                  }
                </div>
              }
            </div>

            <div class="mb-3">
              <label for="descripcion" class="form-label fw-semibold">Descripción</label>
              <textarea
                id="descripcion"
                formControlName="descripcion"
                rows="3"
                class="form-control"
                [class.is-invalid]="descripcion && descripcion.invalid && (descripcion.dirty || descripcion.touched)"
                placeholder="Descripción detallada del producto"
              ></textarea>
              @if (descripcion && descripcion.invalid && (descripcion.dirty || descripcion.touched)) {
                <div class="invalid-feedback">
                  @if (descripcion.errors?.['required']) {
                    La descripción es obligatoria.
                  }
                  @if (descripcion.errors?.['maxlength']) {
                    La descripción no puede exceder los 500 caracteres.
                  }
                </div>
              }
            </div>

            <div class="row">
              <div class="col-md-6 mb-3">
                <label for="precio" class="form-label fw-semibold">Precio ($)</label>
                <input
                  id="precio"
                  type="number"
                  formControlName="precio"
                  class="form-control"
                  [class.is-invalid]="precio && precio.invalid && (precio.dirty || precio.touched)"
                  placeholder="0.00"
                  step="0.01"
                >
                @if (precio && precio.invalid && (precio.dirty || precio.touched)) {
                  <div class="invalid-feedback">
                    @if (precio.errors?.['required']) {
                      El precio es obligatorio.
                    }
                    @if (precio.errors?.['min']) {
                      El precio debe ser mayor o igual a 0.
                    }
                  </div>
                }
              </div>

              <div class="col-md-6 mb-3">
                <label for="stock" class="form-label fw-semibold">Stock</label>
                <input
                  id="stock"
                  type="number"
                  formControlName="stock"
                  class="form-control"
                  [class.is-invalid]="stock && stock.invalid && (stock.dirty || stock.touched)"
                  placeholder="0"
                >
                @if (stock && stock.invalid && (stock.dirty || stock.touched)) {
                  <div class="invalid-feedback">
                    @if (stock.errors?.['required']) {
                      El stock es obligatorio.
                    }
                    @if (stock.errors?.['min']) {
                      El stock debe ser mayor o igual a 0.
                    }
                  </div>
                }
              </div>
            </div>

            <div class="mb-3">
              <label for="categoria" class="form-label fw-semibold">Categoría</label>
              <input
                id="categoria"
                type="text"
                formControlName="categoria"
                class="form-control"
                [class.is-invalid]="categoria && categoria.invalid && (categoria.dirty || categoria.touched)"
                placeholder="Ej: Electrónica, Ropa, etc."
              >
              @if (categoria && categoria.invalid && (categoria.dirty || categoria.touched)) {
                <div class="invalid-feedback">
                  @if (categoria.errors?.['required']) {
                    La categoría es obligatoria.
                  }
                </div>
              }
            </div>

            <div class="mb-4">
              <label for="imagen" class="form-label fw-semibold">URL de la Imagen</label>
              <input
                id="imagen"
                type="url"
                formControlName="imagen"
                class="form-control"
                [class.is-invalid]="imagen && imagen.invalid && (imagen.dirty || imagen.touched)"
                placeholder="https://ejemplo.com/imagen.jpg"
              >
              @if (imagen && imagen.invalid && (imagen.dirty || imagen.touched)) {
                <div class="invalid-feedback">
                  @if (imagen.errors?.['required']) {
                    La URL de la imagen es obligatoria.
                  }
                </div>
              }
            </div>

            <div class="d-grid gap-2 d-md-flex justify-content-md-end">
              <button
                type="button"
                (click)="resetForm()"
                class="btn btn-outline-secondary"
              >
                @if (modoEdicion) {
                  Cancelar
                } @else {
                  Limpiar
                }
              </button>
                @if (modoEdicion) {
                  <button
                    type="submit"
                    [disabled]="productForm.invalid"
                    class="btn btn-primary"
                  >
                    Guardar Cambios
                  </button>
                } @else {
                  <button
                    type="submit"
                    [disabled]="productForm.invalid"
                    class="btn btn-primary"
                  >
                    Crear Producto
                  </button>
                }
            </div>

          </form>
        </div>
      </div>
    </div>
  </div>
</div>
