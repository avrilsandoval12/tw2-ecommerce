<form [formGroup]="form" (ngSubmit)="sendProduct()" autocomplete="off">

  <div class="mb-3">
    <label for="nombre" class="form-label fw-semibold">Nombre</label>
    <input
      id="nombre"
      type="text"
      formControlName="nombre"
      class="form-control"
      [class.is-invalid]="nombre && nombre.invalid && nombre.touched"
      placeholder="Nombre del producto"
    >
    @if (nombre && nombre.hasError('required') && nombre.touched) {
      <span class="text-danger small">Este campo es obligatorio</span>
    }
    @if (nombre && nombre.hasError('maxlength') && nombre.touched) {
      <span class="text-danger small">El nombre no puede exceder los 100 caracteres</span>
    }
  </div>

  <div class="mb-3">
    <label for="descripcion" class="form-label fw-semibold">Descripción</label>
    <textarea
      id="descripcion"
      formControlName="descripcion"
      rows="3"
      class="form-control"
      [class.is-invalid]="descripcion && descripcion.invalid && descripcion.touched"
      placeholder="Descripción detallada del producto"
    ></textarea>
    @if (descripcion && descripcion.hasError('required') && descripcion.touched) {
      <span class="text-danger small">Este campo es obligatorio</span>
    }
    @if (descripcion && descripcion.hasError('maxlength') && descripcion.touched) {
      <span class="text-danger small">La descripción no puede exceder los 500 caracteres</span>
    }
  </div>

  <div class="row">
    <div class="col-md-6 mb-3">
      <label for="precio" class="form-label fw-semibold">Precio ($)</label>
      <input
        id="precio"
        type="number"
        formControlName="precio"
        class="form-control"
        [class.is-invalid]="precio && precio.invalid && precio.touched"
        placeholder="0.00"
        step="0.01"
      >
      @if (precio && precio.hasError('required') && precio.touched) {
        <span class="text-danger small">Este campo es obligatorio</span>
      }
      @if (precio && precio.hasError('min') && precio.touched) {
        <span class="text-danger small">El precio debe ser mayor o igual a 0</span>
      }
    </div>

    <div class="col-md-6 mb-3">
      <label for="stock" class="form-label fw-semibold">Stock</label>
      <input
        id="stock"
        type="number"
        formControlName="stock"
        class="form-control"
        [class.is-invalid]="stock && stock.invalid && stock.touched"
        placeholder="0"
      >
      @if (stock && stock.hasError('required') && stock.touched) {
        <span class="text-danger small">Este campo es obligatorio</span>
      }
      @if (stock && stock.hasError('min') && stock.touched) {
        <span class="text-danger small">El stock debe ser mayor o igual a 0</span>
      }
    </div>
  </div>

  <div class="mb-3">
    <label for="categoria" class="form-label fw-semibold">Categoría</label>
    <input
      id="categoria"
      type="text"
      formControlName="categoria"
      class="form-control"
      [class.is-invalid]="categoria && categoria.invalid && categoria.touched"
      placeholder="Categoría del producto"
    >
    @if (categoria && categoria.hasError('required') && categoria.touched) {
      <span class="text-danger small">Este campo es obligatorio</span>
    }
  </div>

  <div class="mb-4">
    <label class="form-label fw-semibold">Imagen del Producto</label>

    @if (imagePreview) {
      <div class="card mb-3">
        <div class="card-body p-3">
          <div class="d-flex gap-3 align-items-center">
            <img
              [src]="imagePreview"
              alt="Preview"
              class="rounded"
              style="width: 120px; height: 120px; object-fit: cover;">
            <div class="flex-grow-1">
              <p class="mb-2 small text-muted">Vista previa de la imagen</p>
              <button
                type="button"
                class="btn btn-sm btn-outline-danger"
                (click)="removeImage()">
                <i class="bi bi-trash me-1"></i>
                Eliminar imagen
              </button>
            </div>
          </div>
        </div>
      </div>
    }

    <div class="input-group">
      <input
        id="fileInput"
        type="file"
        class="form-control"
        accept="image/*"
        (change)="onFileSelected($event)">
      <label class="input-group-text" for="fileInput">
        <i class="bi bi-upload me-1"></i>
        Seleccionar
      </label>
    </div>
    <small class="text-muted d-block mt-1">
      Tamaño máximo: 5MB
.     </small>
  </div>

  <div class="row mt-3 text-center">
    <div class="col">
      <button
        type="submit"
        [disabled]="form.invalid"
        class="btn btn-success rounded-pill px-5"
      >
        {{ title }}
      </button>
    </div>
  </div>
</form>
